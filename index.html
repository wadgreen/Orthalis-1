<!DOCTYPE html>

<html lang="fr">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login cabinet</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection" />
    <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
</head>

<body>

    <!-- Header -->
    <header class="center">
        <br><br>
        <img src="img/logo-orthalis.png" alt="" class="responsive-img">
        <br><br>
    </header>
    <!-- Sections -->
    <section class="container center">
        <form action="" method="post">
            <div class="container input-field">
                <i class="material-icons prefix">textsms</i>
                <input type="password" name="codeCabinet" id="codeCabinet" class="autocomplete" minlength="8" maxlength="8" required>
                <label>Taper votre identifiant Cabinet :</label>
                <br><br>
                <button type="submit" id="submit" class="waves-effect waves-light btn">Se connecter</button>
            </div>
            <div id="resultat"></div>
        </form>
    </section>
    <!-- Pieds de page -->
    <footer class="footer grey-text">
        <div class="container qrCode center-align">
            <img src="img/qr-code-150x150.png" alt="" class="responsive-img">
            <p>Politique de confidentialité</p>
            <p>Termes et conditions</p>
        </div>
    </footer>
    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="js/materialize.js"></script>
    <script src="js/init.js"></script>

</body>

</html>

<script>

    $(document).ready(function () {

        $("#submit").click(function (e) {
            e.preventDefault();
            $.post(
                'http://fabriquenumerique.fr/OrthalisDemo/connexion.php',
                {
                    codeCabinet: $("#codeCabinet").val() // Nous récupérons la valeur de nos input que l'on fait passer à connexion.php
                },
                function (data) {
                    if (data != 'Error') {
                        // Le membre est connecté. Ajoutons lui un message dans la page HTML.
                        $("#resultat").html("<p>Vous avez été connecté avec succès !</p>");
                        localStorage.setItem("id_cabinet", data);
                        
                    }
                    else {
                        // Le membre n'a pas été connecté. (data vaut ici "failed")
                        $("#resultat").html("Mauvais code cabinet");
                    }
                },
                'text'
            );
        });

    });
</script>
